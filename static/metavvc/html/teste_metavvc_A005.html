<!DOCTYPE html>
<html lang="pt-br">
<head>
<title>MetaVVC - Ambiente virtual apenas com JS</title>
<meta charset="utf-8">
<style>
	body {
		font-family: Arial, Helvetica, sans-serif;
		font-weight: bold;
		padding: 0px;
		margin : 0px;
		border:0px;
		background-color: blue;
	}
	#DivIntroload{
		display : none;
	}
	.divIntro{
		background-image: url(/static/assetsv5/img/metaversovvcinit.jpg);
		font-size: 16px;
		background-size: 100%;
		position: absolute;
		top: 0px;
		height: 100%;
		width: 100%;
		text-align: center;
		color: #FFFFFF;
		font-size: 50px;
	}
	.divControles{
		position: absolute;
		top: 0px;
		height: 100%;
		width: 100%;
	}
	.justific{
		display: flex;
		justify-content: space-between;
		width: 100%;
	}
	.controles{
		font-size: 20px;
		height: 80%;
		bottom: 0
	}
	.spanDados{
		color: #FFFFFF;
		font-size: 20px;
	}
	.divControEsq{
		padding: 10px;
		width: 24%;
	}
	.divControCentro{
		width: 60%;
		padding: 10px;
	}
	.divControDire{
		padding: 10px;
		width: 24%;
	}
	.divDadosP{
		width: 10%;
	}
	.divDadosM{
		width: 15%;
	}
	.divDadosG{
		width: 20%;
	}
	
	.joystickConteiner{
		width: 200px;
		height: 200px;
		align-items: center;
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		justify-content: center;
		border:solid 3px;
		border-radius:50%;
		border-color:#fff;
		background-color: #000;
		opacity: 0.2;
	}              
	
	.joystickClass{
		position: absolute;
		background-color: #fff;
		width: 100px;
		height: 100px;
		border-color:#000;
		border:solid 1px;
		border-radius:50%;
		opacity: 0.3;
	}
	
	</style>
</head>

<body>
	<script src="/static/assetsv5/js/three.min.js"></script>
	<script src="/static/assetsv5/js/GLTFLoader.js"></script>
<script>

var renderer = new THREE.WebGLRenderer();
var x, y, scene, camera;
var idSpanDados1, idSpanDados2, idSpanDados3, idSpanTitulo, idSpanURL
var listObjEmCena=[];
var geometry=[];
var material=[];
const pixel3d=10;
const largura=window.innerWidth;
const altura=window.innerHeight;
var listLus = [];
var carregando = 0;
var andarAtual = "";
 
var Obj3Dglb = {
	elevador : {carrega : false, url:"/static/metavvc/3d/meta_vvc_elevador.glb", objeto3D : "vazio"},
	design  : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_design.glb", objeto3D : "vazio", links:[]},
	eu : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_eu.glb", objeto3D : "vazio", links:[]},
	home : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_home2.glb", objeto3D : "vazio", links:[]},
	jogos : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_jogos.glb", objeto3D : "vazio", links:[]},
	tutorial : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_tutorial.glb", objeto3D : "vazio", links:[]},
	utilitarios : {carrega : false, url:"/static/metavvc/3d/meta_vvc_sala_utilitarios.glb", objeto3D : "vazio", links:[]},
	maos : {carrega : false, url:"/static/metavvc/3d/maos_player_2.glb", objeto3D : "vazio"}

};

//Helper
// URL https://vvcestudio.com.br
// elevador x:0, y:0, z:0

Obj3Dglb.home.links[0]={titulo:"Home", url:"/", x:0, y:0, z:417}

Obj3Dglb.jogos.links[0]={titulo:"Jogos",url:"/pt/game/", x:-3, y:0, z:122}
Obj3Dglb.jogos.links[1]={titulo:"Jogo CristalBot",url:"/pt/game/cristalbot/", x:77, y:0, z:167}
Obj3Dglb.jogos.links[2]={titulo:"Jogo Omelete de Dino",url:"/pt/game/omeletededino/", x:145, y:0, z:200}
Obj3Dglb.jogos.links[3]={titulo:"Jogo Sonic",url:"/pt/game/sonic/", x:155, y:0, z:300}
Obj3Dglb.jogos.links[4]={titulo:"Jogo Tenque",url:"/pt/game/tanque/", x:156, y:0, z:408}
Obj3Dglb.jogos.links[5]={titulo:"Jogo Cobrinha",url:"/pt/game/cobrinha/", x:81, y:0, z:433}
Obj3Dglb.jogos.links[6]={titulo:"Jogo Cobrinha 3D",url:"/pt/game/cobrinha3d/", x:-82, y:0, z:440}
Obj3Dglb.jogos.links[7]={titulo:"Jogo Tetris",url:"/pt/game/tetris/", x:-141, y:0, z:408}
Obj3Dglb.jogos.links[8]={titulo:"Jogo Tetris 3D",url:"/pt/game/tetris3d/", x:-148, y:0, z:300}
Obj3Dglb.jogos.links[9]={titulo:"Jogo wolfenstein 3d",url:"/pt/game/wolf/", x:-155, y:0, z:200}
Obj3Dglb.jogos.links[10]={titulo:"Jogos Educativos",url:"/pt/game/edu/", x:-84, y:0, z:167}
 
Obj3Dglb.utilitarios.links[0]={titulo:"Ferramentas", url:"/pt/utilitarios/", x:-2, y:0, z:122}
Obj3Dglb.utilitarios.links[1]={titulo:"Relogio Digital JS", url:"/pt/utilitarios/relogiodigital/", x:38, y:0, z:376}
Obj3Dglb.utilitarios.links[2]={titulo:"Relogio Analogico JS", url:"/pt/utilitarios/relogioanalogico/", x:100, y:0, z:360}
Obj3Dglb.utilitarios.links[3]={titulo:"Conversor de Texto JS", url:"/pt/utilitarios/conversordetexto/", x:33, y:0, z:367}
Obj3Dglb.utilitarios.links[4]={titulo:"Conversor de Unidade JS", url:"/pt/utilitarios/conversordeunidade/", x:158, y:0, z:326}
Obj3Dglb.utilitarios.links[5]={titulo:"V-Editor3d", url:"/pt/utilitarios/veditor3d/", x:148, y:0, z:247}
Obj3Dglb.utilitarios.links[6]={titulo:"Servicos Gratuitos", url:"/pt/utilitarios/servicosgratuitos/", x:172, y:0, z:150}

Obj3Dglb.tutorial.links[0]={titulo:"Tutoriais",url:"/pt/tutorial/", x:5, y:0, z:122}

Obj3Dglb.tutorial.links[1]={titulo:"Tutorial HTML",url:"/pt/tutorial/html/", x:-215, y:130, z:150}
Obj3Dglb.tutorial.links[2]={titulo:"Estrutura do HTML",url:"/pt/tutorial/html/estrutura/", x:-215, y:130, z:250}
Obj3Dglb.tutorial.links[3]={titulo:"Titulo e Paragrafo HTML",url:"/pt/tutorial/html/h1_p_br/", x:-215, y:130, z:350}
Obj3Dglb.tutorial.links[4]={titulo:"Lista HTML",url:"/pt/tutorial/html/lista01/", x:-215, y:130, z:450}
Obj3Dglb.tutorial.links[5]={titulo:"Tutorial HTML Tabelas",url:"/pt/tutorial/html/tabela/", x:-215, y:130, z:550}
Obj3Dglb.tutorial.links[6]={titulo:"Tutorial div span",url:"/pt/tutorial/html/div_span/", x:215, y:130, z:550}
Obj3Dglb.tutorial.links[7]={titulo:"Detail HTML",url:"/pt/tutorial/html/details/", x:215, y:130, z:450}
Obj3Dglb.tutorial.links[8]={titulo:"Canvas HTML",url:"/pt/tutorial/html/canvas/", x:215, y:130, z:350}
Obj3Dglb.tutorial.links[9]={titulo:"Tutorial CSS",url:"/pt/tutorial/css/", x:215, y:130, z:250}
Obj3Dglb.tutorial.links[10]={titulo:"Tutorial CCS",url:"/pt/tutorial/css/css02/", x:215, y:130, z:150}

Obj3Dglb.tutorial.links[11]={titulo:"Introdução ao JavaScript",url:"/pt/tutorial/javascript/", x:-215, y:0, z:150}
Obj3Dglb.tutorial.links[12]={titulo:"Tutorial NodeJS",url:"/pt/tutorial/javascript/nodejs/", x:-215, y:0, z:250}
Obj3Dglb.tutorial.links[13]={titulo:"tutoriais",url:"/pt/tutorial/javascript/reactjs/", x:-215, y:0, z:350}
Obj3Dglb.tutorial.links[14]={titulo:"Componentes React",url:"/pt/componentes/", x:-215, y:0, z:450}
Obj3Dglb.tutorial.links[15]={titulo:"Tutorial NextJS",url:"/pt/tutorial/javascript/nextjs/", x:-215, y:0, z:550}
Obj3Dglb.tutorial.links[16]={titulo:"Tutorial ThreeJS",url:"/pt/tutorial/javascript/three/", x:215, y:0, z:550}
Obj3Dglb.tutorial.links[17]={titulo:"tutoriais",url:"/pt/tutorial/javascript/p5/", x:215, y:0, z:450}
Obj3Dglb.tutorial.links[18]={titulo:"tutoriais",url:"/pt/tutorial/javascript/babylon/", x:215, y:30, z:350}
Obj3Dglb.tutorial.links[19]={titulo:"tutoriais",url:"/pt/tutorial/javascript/knockout/", x:215, y:30, z:250}
Obj3Dglb.tutorial.links[20]={titulo:"tutoriais",url:"/pt/tutorial/html/canvas/", x:215, y:30, z:150}

Obj3Dglb.tutorial.links[21]={titulo:"tutorial SVG",url:"/pt/tutorial/html/svg01/", x:-215, y:-130, z:150}
Obj3Dglb.tutorial.links[22]={titulo:"O que é Java",url:"/pt/tutorial/java/", x:-215, y:-130, z:250}
Obj3Dglb.tutorial.links[23]={titulo:"tutorial ASP",url:"pt/tutorial/asp/", x:-215, y:-130, z:350}
Obj3Dglb.tutorial.links[24]={titulo:"Tutorial Python",url:"/pt/tutorial/python/", x:-215, y:-130, z:450}
Obj3Dglb.tutorial.links[25]={titulo:"tutorial PHP",url:"/pt/tutorial/php/", x:-215, y:-130, z:550}
Obj3Dglb.tutorial.links[26]={titulo:"Tutorial Apache",url:"/pt/tutorial/apache/", x:215, y:-130, z:550}
Obj3Dglb.tutorial.links[27]={titulo:"Banco de Dados",url:"/pt/tutorial/bancodedados/", x:215, y:-130, z:450}
Obj3Dglb.tutorial.links[28]={titulo:"Ciência de Dados",url:"/pt/tutorial/bancodedados/datascience/", x:215, y:-130, z:350}
Obj3Dglb.tutorial.links[29]={titulo:"O que é CGI",url:"/pt/tutorial/cgi/", x:215, y:-130, z:250}
Obj3Dglb.tutorial.links[30]={titulo:"O que é SEO?",url:"/pt/tutorial/seo/", x:215, y:-130, z:150}

Obj3Dglb.design.links[0]={titulo:"VVC Design",url:"/pt/design/", x:0, y:0, z:145}
Obj3Dglb.design.links[1]={titulo:"Exposição ilustracao",url:"/pt/design/ilustracao/", x:-266, y:20, z:90}
Obj3Dglb.design.links[2]={titulo:"maquete3d",url:"/pt/design/maquete3d/", x:-262, y:-20, z:203}
Obj3Dglb.design.links[3]={titulo:"modelagem3d",url:"/pt/design/modelagem3d/", x:-45, y:20, z:340}
Obj3Dglb.design.links[4]={titulo:"pintura",url:"/pt/design/pintura/", x:68, y:-20, z:340}
Obj3Dglb.design.links[5]={titulo:"logo",url:"/pt/design/logo/", x:190, y:20, z:181}
Obj3Dglb.design.links[6]={titulo:"layoutweb",url:"/pt/design/layoutweb/", x:212, y:-20, z:95}

Obj3Dglb.eu.links[0]={titulo:"Eu",url:"/pt/eu/", x:0, y:0, z:97}
Obj3Dglb.eu.links[1]={titulo:"Meu curriculo",url:"/pt/eu/curriculo/", x:-2, y:0, z:220}


function initLight(){

	// Lus da Lanterna
	listLus[0] = new THREE.PointLight( 0x505050, 2, 200 ); // Cria Luz
	listLus[0].position.set( 10, 10, 10 );
	listLus[0].castShadow = true;
	listLus[0].shadow.mapSize.width = 512; // default
	listLus[0].shadow.mapSize.height = 512; // default
	listLus[0].shadow.camera.near = 0.5; // default
	listLus[0].shadow.camera.far = 500; // default
	scene.add( listLus[0] );

	// Lus do elevador
	listLus[1] = new THREE.PointLight( 0x505050, 2, 200 ); // Cria Luz
	listLus[1].position.set( 1, 91, 1 );
	scene.add( listLus[1] );

	listLus[2] = new THREE.DirectionalLight("rgb(50,50,90)", 2);
	listLus[2].position.x = 0;
	listLus[2].position.y = 51;
	listLus[2].position.z = 4;
	listLus[2].rotation.x = 2.56;
	listLus[2].rotation.z = 1.13;
	scene.add(listLus[2]);
	
	
	listLus[3] = new THREE.DirectionalLight("rgb(50,50,45)", 2);
	listLus[3].position.x = 0;
	listLus[3].position.y = -51;
	listLus[3].position.z = -40;
	listLus[3].rotation.x = -2.16;
	listLus[3].rotation.z = -2.13;
	scene.add(listLus[3]);
}

function initMaterial(){
	/*
	const loader = new THREE.TextureLoader();
	const urlImgTexture = loader.load('https://st3.depositphotos.com/30440304/i/600/depositphotos_343055824-stock-photo-seamless-scifi-panels-futuristic-texture.jpg');
	const listaMateriais = [
                new THREE.MeshBasicMaterial({map: urlImgTexture}),
                new THREE.MeshBasicMaterial({map: urlImgTexture}),
                new THREE.MeshBasicMaterial({map: urlImgTexture}),
                new THREE.MeshBasicMaterial({map: urlImgTexture}),
                new THREE.MeshBasicMaterial({map: urlImgTexture}),
                new THREE.MeshBasicMaterial({map: urlImgTexture})
            ];
	*/
	material[0] = new THREE.MeshLambertMaterial({ color: "rgb(255,255,255)"});
	material[1] = new THREE.MeshLambertMaterial({ color: "rgb(192,192,192)"});
	material[2] = new THREE.MeshLambertMaterial({ color: "rgb(128,128,128)"});
	material[3] = new THREE.MeshLambertMaterial({ color: "rgb(255,0,0)"});
	material[4] = new THREE.MeshLambertMaterial({ color: "rgb(158,0,0)"});
	material[5] = new THREE.MeshLambertMaterial({ color: "rgb(98,0,0)"});
	material[6] = new THREE.MeshLambertMaterial({ color: "rgb(255,255,0)"});
	material[7] = new THREE.MeshLambertMaterial({ color: "rgb(176,176,0)"});
	material[8] = new THREE.MeshLambertMaterial({ color: "rgb(255,162,0)"});
	material[9] = new THREE.MeshLambertMaterial({ color: "rgb(176,176,0)"});
	material[10] = new THREE.MeshLambertMaterial({ color: "rgb(138,87,0)"});
	material[11] = new THREE.MeshLambertMaterial({ color: "rgb(255,0,200)"});
	material[12] = new THREE.MeshLambertMaterial({ color: "rgb(124,56,143)"});
	material[13] = new THREE.MeshLambertMaterial({ color: "rgb(0,255,42)"});
	material[14] = new THREE.MeshLambertMaterial({ color: "rgb(0,117,20)"});
	material[15] = new THREE.MeshLambertMaterial({ color: "rgb(0,138,135)"});
	material[16] = new THREE.MeshLambertMaterial({ color: "rgb(0,0,255)"});
	material[17] = new THREE.MeshLambertMaterial({ color: "rgb(0,0,125)"});
	material[18] = new THREE.MeshLambertMaterial({ color: "rgb(0,238,255)"});
	//material[18] = new THREE.MeshBasicMaterial({map: urlImgTexture});
	/*
	material[18] = [
				listaMateriais[0],
				listaMateriais[1],
				listaMateriais[2],
				listaMateriais[3],
				listaMateriais[4],
				listaMateriais[5]
    ];
	*/
}

function init(){

	renderer.shadowMap.enabled = true;
	renderer.shadowMap.type = THREE.PCFSoftShadowMap; // default THREE.PCFShadowMap


	DivIntroA.style.display = "none"; //Esconder Janela de Informacões.
	DivIntroload.style.display = "center"; //Esconder Janela de Informacões.
	scene = new THREE.Scene();
		
	initMaterial()

	// Camera
	camera = new THREE.PerspectiveCamera( 50, largura / altura, 1, pixel3d*10000 );
	scene.add(camera);
	camera.position.x = -80;
	camera.position.y = 80;
	camera.position.z = 280;
	//camera.rotation.x = -0.45;
	//camera.rotation.y = -0.45;
	//camera.rotation.z = -0.24;

	initLight();

	// =Objeto=Elevador============================================================
	geometry[0] = new THREE.BoxGeometry(100,60,10);
	listObjEmCena[0] = new THREE.Mesh( geometry[0], material[11] );
	scene.add(listObjEmCena[0]);
	listObjEmCena[0].position.x = 0;
	listObjEmCena[0].position.y = 40;
	listObjEmCena[0].position.z = -55;

	//=Objeto=Elevador=============================================================
	geometry[1] = new THREE.BoxGeometry(85,60,130);
	listObjEmCena[1] = new THREE.Mesh( geometry[1], material[11] );
	scene.add(listObjEmCena[1]);
	listObjEmCena[1].position.x = -85;
	listObjEmCena[1].position.y = 40;
	listObjEmCena[1].position.z = 10;

	//=Objeto=Elevador=============================================================
	geometry[2] = new THREE.BoxGeometry(85,60,130);
	listObjEmCena[2] = new THREE.Mesh( geometry[1], material[11] );
	scene.add(listObjEmCena[2]);
	listObjEmCena[2].position.x = 85;
	listObjEmCena[2].position.y = 40;
	listObjEmCena[2].position.z = 10;

	// =Objeto==============================================================
	geometry[3] = new THREE.BoxGeometry(10,40,10);
	listObjEmCena[3] = new THREE.Mesh( geometry[3], material[11] );
	scene.add(listObjEmCena[3]);
	listObjEmCena[3].position.x = 85;
	listObjEmCena[3].position.y = 40;
	listObjEmCena[3].position.z = 80;
	
	// =Objeto==============================================================
	geometry[4] = new THREE.BoxGeometry(10,40,10);
	listObjEmCena[4] = new THREE.Mesh( geometry[4], material[8] );
	scene.add(listObjEmCena[4]);
	listObjEmCena[4].position.x = 85;
	listObjEmCena[4].position.y = 40;
	listObjEmCena[4].position.z = 100;
	
	// =Objeto==============================================================
	geometry[5] = new THREE.BoxGeometry(10,40,10);
	listObjEmCena[5] = new THREE.Mesh( geometry[5], material[8] );
	scene.add(listObjEmCena[5]);
	listObjEmCena[5].position.x = 85;
	listObjEmCena[5].position.y = 40;
	listObjEmCena[5].position.z = 110;
	
	// =Objeto==============================================================
	geometry[6] = new THREE.BoxGeometry(10,40,10);
	listObjEmCena[6] = new THREE.Mesh( geometry[6], material[13] );
	scene.add(listObjEmCena[6]);
	listObjEmCena[6].position.x = 85;
	listObjEmCena[6].position.y = 40;
	listObjEmCena[6].position.z = 120;
	
	// =Objeto==============================================================
	geometry[7] = new THREE.BoxGeometry(10,40,10); // Avatar
	listObjEmCena[7] = new THREE.Mesh( geometry[7], material[0] );
	//scene.add(listObjEmCena[7]);
	listObjEmCena[7].position.x = 85;
	listObjEmCena[7].position.y = 40;
	listObjEmCena[7].position.z = 0;
	
	// =Objeto==============================================================
	geometry[8] = new THREE.BoxGeometry(10,40,10);
	listObjEmCena[8] = new THREE.Mesh( geometry[8], material[3] );
	scene.add(listObjEmCena[8]);
	listObjEmCena[8].position.x = 85;
	listObjEmCena[8].position.y = 40;
	listObjEmCena[8].position.z = 67;
	

	renderer.setSize(largura,altura);
	document.body.appendChild( renderer.domElement );
	document.addEventListener("keydown", keyPush);
	
	//===================================================================================

	initPlayer();
	initElevador();
	//initSalaGames();
	//initSalaTutorial();
	initSalaHome();
	//initSalaEu();
	//initSalaDesign();
	//initSalaUtil();
	 
	idSpanDados1 = document.getElementById("idSpanDados1")
	idSpanDados2 = document.getElementById("idSpanDados2")
	idSpanDados3 = document.getElementById("idSpanDados3")
	idSpanTitulo = document.getElementById("idSpanTitulo")
	idSpanURL = document.getElementById("idSpanURL")
	initJoystick()

};

function sairDoAndar(varAndarAtual){
	if(varAndarAtual=="design"){
		scene.remove(Obj3Dglb.design.objeto3D);
	}else if(varAndarAtual=="eu"){
		scene.remove(Obj3Dglb.eu.objeto3D);
	}else if(varAndarAtual=="home"){
		scene.remove(Obj3Dglb.home.objeto3D);
	}else if(varAndarAtual=="jogos"){
		scene.remove(Obj3Dglb.jogos.objeto3D);
	}else if(varAndarAtual=="tutorial"){
		scene.remove(Obj3Dglb.tutorial.objeto3D);
	}else if(varAndarAtual=="utilitarios"){
		scene.remove(Obj3Dglb.utilitarios.objeto3D);
	}
}


function initPlayer(){
	// player 1a pessoa
	if(Obj3Dglb.maos.carrega==false){
		Obj3Dglb.maos.carrega=true;
		let loaderObj3D = new THREE.GLTFLoader();  //O ERRO COM ISSO, TENTEI SEM THREE. USANDO APENAS O GLTLOADER() MAS NaO FUNCIONOU 
		loaderObj3D.load( Obj3Dglb.maos.url, function ( gltf ) {	
			console.log("carregou arquivo 2 GLT. Player 1a pessoa");
			//listObjEmCena[9] = gltf.scene; 
			Obj3Dglb.maos.objeto3D = listObjEmCena[9] = gltf.scene; 
			/*
			var obj = [];
			const groupMaos = new THREE.Group();	
			obj[0] = new THREE.Mesh(gltf.scene.children[0].geometry, material[1]); // Braco1 
			obj[1] = new THREE.Mesh(gltf.scene.children[1].geometry, material[1]); // Braco2 
			groupMaos.add(obj[0]);
			groupMaos.add(obj[1]);
			groupMaos.position.y = groupMaos.position.y+30;
			listObjEmCena[11] = groupMaos; 
			*/
			console.log(listObjEmCena[9].children[0].geometry)
			//listObjEmCena[11].children[0].geometry.y = listObjEmCena[11].children[0].geometry.y+50;
			
			//scene.add(listObjEmCena[9]);
			scene.add(Obj3Dglb.maos.objeto3D);

			fimCarga();
			//renderizar();
		});	
	}
}

function initElevador(){
	// elevador
	if(Obj3Dglb.elevador.carrega==false){
		Obj3Dglb.elevador.carrega=true;
		let loaderObj3D2 = new THREE.GLTFLoader();  
		loaderObj3D2.load( Obj3Dglb.elevador.url, function ( gltf ) {	
			console.log("carregou arquivo 2 GLT elevador");	 	
			Obj3Dglb.elevador.objeto3D = new THREE.Mesh(gltf.scene.children[0].geometry, material[1]);
			//listObjEmCena[10] = new THREE.Mesh(gltf.scene.children[0].geometry, material[1]); // Braco1 
			//scene.add(listObjEmCena[10]);
			Obj3Dglb.elevador.objeto3D.castShadow = true; //default is false
			Obj3Dglb.elevador.objeto3D.receiveShadow = false; //default
			scene.add(Obj3Dglb.elevador.objeto3D);
			fimCarga();
			//renderizar();
		});
	}
}

function initSalaGames(){
	// sala de Jogos
	if(andarAtual!="jogos"){
		sairDoAndar(andarAtual);
		andarAtual="jogos";
		if(Obj3Dglb.jogos.carrega==false){
			Obj3Dglb.jogos.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.jogos.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				//listObjEmCena[12] = new THREE.Mesh(gltf.scene.children[0].geometry, material[1]); // Braco1 
				//listObjEmCena[12] = gltf.scene; 
				Obj3Dglb.jogos.objeto3D = gltf.scene;
				//scene.add(listObjEmCena[12]);
				scene.add(Obj3Dglb.jogos.objeto3D);
				fimCarga();
				//renderizar();
			});
		}else{
			scene.add(Obj3Dglb.jogos.objeto3D);
		}
	}

}

function initSalaTutorial(){
	// sala de Tutorial (Biblioteca)
	if(andarAtual!="tutorial"){
		sairDoAndar(andarAtual);
		andarAtual="tutorial";
		if(Obj3Dglb.tutorial.carrega==false){
			Obj3Dglb.tutorial.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.tutorial.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				Obj3Dglb.tutorial.objeto3D = gltf.scene;
				scene.add(Obj3Dglb.tutorial.objeto3D);
				fimCarga();
			});
		}else{
			scene.add(Obj3Dglb.tutorial.objeto3D);
		}		
	}

}


function initSalaUtil(){
	// sala de Eu (Diretoria)
	if(andarAtual!="utilitarios"){
		sairDoAndar(andarAtual);
		andarAtual="utilitarios";
		if(Obj3Dglb.utilitarios.carrega==false){
			Obj3Dglb.utilitarios.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.utilitarios.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				Obj3Dglb.utilitarios.objeto3D = gltf.scene;
				scene.add(Obj3Dglb.utilitarios.objeto3D);
				fimCarga();
			});
		}else{
			scene.add(Obj3Dglb.utilitarios.objeto3D);
		}
	}

}

function initSalaEu(){
	// sala de Eu (Diretoria)
	if(andarAtual!="eu"){
		sairDoAndar(andarAtual);
		andarAtual="eu";
		if(Obj3Dglb.eu.carrega==false){
			Obj3Dglb.eu.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.eu.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				Obj3Dglb.eu.objeto3D = gltf.scene;
				scene.add(Obj3Dglb.eu.objeto3D);
				fimCarga();
			});
		}else{
			scene.add(Obj3Dglb.eu.objeto3D);
		}
	}

}

function initSalaHome(){
	// sala de home (terreo)
	if(andarAtual!="home"){
		sairDoAndar(andarAtual);
		andarAtual="home";
		if(Obj3Dglb.home.carrega==false){
			Obj3Dglb.home.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.home.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				Obj3Dglb.home.objeto3D = gltf.scene;
				scene.add(Obj3Dglb.home.objeto3D);
				fimCarga();
			});
		}else{
			scene.add(Obj3Dglb.home.objeto3D);
		}
	}
}

function initSalaDesign(){
	// sala de home (terreo)
	if(andarAtual!="design"){
		sairDoAndar(andarAtual);
		andarAtual="design";
		if(Obj3Dglb.design.carrega==false){
			Obj3Dglb.design.carrega=true;
			let loaderObj3D3 = new THREE.GLTFLoader(); 
			loaderObj3D3.load( Obj3Dglb.design.url, function ( gltf ) {	
				console.log("carregou arquivo 2 GLT sala_design");
				Obj3Dglb.design.objeto3D = gltf.scene;
				Obj3Dglb.design.objeto3D.position.y = -15;
				scene.add(Obj3Dglb.design.objeto3D);
				fimCarga();
			});
		}else{
			scene.add(Obj3Dglb.design.objeto3D);
		}
	}

}

function fimCarga(){
	carregando++;
	if(carregando>=3){
		DivIntro.style.display = "none"; //Esconder Janela de Informacoes.
		animate();
	}
}

function animate() {
    requestAnimationFrame( animate ); //Chamar esta funcao novamente quando terminar.
    renderizar();
}



function renderizar(){
	//camera.lookAt( Obj3Dglb.maos.objeto3D.position ); // Manter foco da camera no bloco branco
	//*******************
	idSpanDados1.textContent="PLayer: x="+Obj3Dglb.maos.objeto3D.position.x + ", y=" + Obj3Dglb.maos.objeto3D.position.y + ", z=" + Obj3Dglb.maos.objeto3D.position.z; 
	idSpanDados2.textContent="Sene:"+andarAtual+", angulo:"+angulo;
	idSpanDados3.textContent="focox:"+fococamera.x+", focoz:"+fococamera.z+", ladox:"+fococamera.ladox+", ladoz:"+fococamera.ladoz;
	idSpanTitulo.textContent="Titulo:"+Obj3Dglb[andarAtual].links[0].titulo;
	idSpanURL.textContent="URL:"+Obj3Dglb[andarAtual].links[0].url; 
	renderer.render(scene, camera);
}

function keyPush(e) {
    //Ações do teclado.
    var varKey = e.key;
    var varkeyCode = e.keyCode
    if (varkeyCode === 37 || varkeyCode === 65 || varKey == "ArrowLeft") {
      //console.log("37=(<)esquerda / 65=a"); 
	  rotacionar(0.25);
    } else if (varkeyCode === 39 || varkeyCode === 68 || varKey == "ArrowRight") {
      //console.log("39=(>)Direita / 68=d");
      rotacionar(-0.25); 
    } else if (varkeyCode === 40 || varkeyCode === 83 || varKey == "ArrowDown") {
      //console.log("40=seta pra baixo / 83=s"); ("re"); //"descer"
	  moverPersonagem(1);
	} else if (varkeyCode === 87 || varkeyCode === 38 || varKey == "ArrowUp") {
      //console.log("30=seta pra cima / 87=w"); ("frente"); //"subir"
      moverPersonagem(-1);
	} else if (varkeyCode === 81 || varKey == "q") {
      //varkeyCode:81 | varKey:q // mover de lado
	  moverPersonLado(-1);
	} else if (varkeyCode === 69 || varKey == "r") {
	  //varkeyCode:69 | varKey:e // mover de lado
      moverPersonLado(1);
	} else if (varkeyCode === 17 || varKey == "Control") {
	  //varkeyCode:17 | varKey:Control
      atirar();
	} else if (varkeyCode === 82 || varKey == "r") {
      //moverPersonagem("subir");	//voar/subir/pular  
    } else if (varkeyCode === 70 || varKey == "f") {
      //moverPersonagem("descer"); //descer/abaixar
	} else if (varkeyCode === 32 || varKey == " ") {
	  //moverPersonagem("pula"); //descer/abaixar 
    } else{
	  console.log("varkeyCode:"+varkeyCode+" | varKey:"+varKey);
	}
  }

 var atirando = 0;
 
 function atirar(){
	atirando=2;
	//renderizar();
 }

/*
function colidBox2d(rect1, rect2){
  if(rect1.x+rect1.width/2 > rect2.x-rect2.width/2 &&
	rect1.x-rect1.width/2 < rect2.x+rect2.width/2 &&
	rect1.z+rect1.width/2 > rect2.y-rect2.width/2 &&
	rect1.y-rect1.width/2 < rect2.y+rect2.width/2){
	//tocou
	//console.log("tocou");
	return true;
  } 
  //nao tocou
  return false;
}
*/

function colidBox3d(rect1, rect2){
  console.log("colidBox3d(x="+rect1.x+",z="+rect1.z+",w="+rect1.width+",h="+rect1.height+",d="+rect1.depth);
  if(rect1.x+rect1.width/2 > rect2.x-rect2.width/2 &&
	rect1.x-rect1.width/2 < rect2.x+rect2.width/2 &&
	rect1.y+rect1.height/2 > rect2.y-rect2.height/2 &&
	rect1.y-rect1.height/2 < rect2.y+rect2.height/2 &&
	rect1.z+rect1.depth/2 > rect2.z-rect2.depth/2 &&
	rect1.z-rect1.depth/2 < rect2.z+rect2.depth/2
	){
	//tocou
	console.log("!!!!!!!!!! tocou !!!!!!!!!!!!!!");
	return true;
  } 
  //nao tocou
  return false;
}

function colideForObjetos(){
	var respTocou = false;
	var Tocou = false;
	//0=camera //type: "PerspectiveCamera"
	//1=chao //type: "SpotLight"
	//2=luz //type:"Mesh"
	//geometry.type:'BoxGeometry'

	//const letPlayer = convertcolidObj(7);
	//let objatual = {};
	for (let i = 0; i < 9; i++ ) {
		console.log("colideForObjetos()=>for=>"+i);
		//if(listObjEmCena[i].type=="Mesh"){		
			//let objatual = listObjEmCena[i];
			//Tocou = colidBox3d(convertcolidObj(i),letPlayer);
			Tocou = colidBox3d(
				{
				"x":listObjEmCena[i].position.x,
				"y":listObjEmCena[i].position.y,
				"z":listObjEmCena[i].position.z, 
				"width":listObjEmCena[i].geometry.parameters.width, 
				"height":listObjEmCena[i].geometry.parameters.height,
				"depth":listObjEmCena[i].geometry.parameters.depth
				},
				{
				"x":Obj3Dglb.maos.objeto3D.position.x,
				"y":Obj3Dglb.maos.objeto3D.position.y,
				"z":Obj3Dglb.maos.objeto3D.position.z, 
				"width":25, 
				"height":25,
				"depth":50
				}
			);
		//}
		if(Tocou==true){
			respTocou = true;
			console.log("Tocou i="+i);
			i=10;
		}
	}
	console.log("respTocou="+respTocou);
	return respTocou;
}

var angulo = 0;
var fococamera = {x:0,z:-5,ladox:5,ladoz:0}

function rotacionar(varRot){
	// varRot = -1 ou +1
	const limite = 5;
	if(fococamera.z<=0 && fococamera.x<=0 && fococamera.z>=-5 && fococamera.x>=-5){
		fococamera.z = fococamera.z-varRot
		fococamera.x = fococamera.x+varRot
		//lado	
		fococamera.ladoz = fococamera.ladoz+varRot
		fococamera.ladox = fococamera.ladox+varRot		
	} else if(fococamera.z<=0 && fococamera.x>=0 && fococamera.z>=-5 && fococamera.x<=5){
		fococamera.z = fococamera.z+varRot
		fococamera.x = fococamera.x+varRot
		//lado
		fococamera.ladoz = fococamera.ladoz+varRot
		fococamera.ladox = fococamera.ladox-varRot
	} else if(fococamera.z>=0 && fococamera.x>=0 && fococamera.z<=5 && fococamera.x<=5){
		fococamera.z = fococamera.z+varRot
		fococamera.x = fococamera.x-varRot
		//lado
		fococamera.ladoz = fococamera.ladoz-varRot
		fococamera.ladox = fococamera.ladox-varRot
	} else if(fococamera.z>=0 && fococamera.x<=0 && fococamera.z<=5 && fococamera.x>=-5){
		fococamera.z = fococamera.z-varRot
		fococamera.x = fococamera.x-varRot
		//ladoz	
		fococamera.ladoz = fococamera.ladoz-varRot
		fococamera.ladox = fococamera.ladox+varRot
	}
	if(fococamera.z<-5){
		fococamera.z=-4;
	}else if(fococamera.z>5){
		fococamera.z=4;
	}
	if(fococamera.x<-5){
		fococamera.x=-4;
	}else if(fococamera.x>5){
		fococamera.x=4;
	}
	angulo = Math.atan2(fococamera.z, fococamera.x); // Calcula o radiano de um vetor 2D iniciado em 0,0.

	/*
	angulo = angulo+(varRot*0.19634375) // angulo = angulo+(varRot*0.75)
	//if(angulo>3.70){
	if(angulo>3.1416){
		angulo = -3.1415 // antigo "-2.25"
	//}else if(angulo<-2.25){
	}else if(angulo<-3.1416){
		angulo = 3.1415; //antigo "3"
	}
	*/

	console.log("Rot"+varRot+", x="+fococamera.x+", z="+fococamera.z+", radiano"+angulo);
	//listObjEmCena[9].rotation.y = angulo;// Rotacionar  
	positionCamera()
	//renderizar();
}

/*
function moverCamera(positX, positY, positZ) {
	camera.position.x = positX;
	camera.position.y = positY+45;
	camera.position.z = positZ+100;
}
*/

function positionCamera() {
	//Camera
	camera.position.y = Obj3Dglb.maos.objeto3D.position.y+50;//camera
	camera.position.x = Obj3Dglb.maos.objeto3D.position.x+fococamera.z*2;
	camera.position.z = Obj3Dglb.maos.objeto3D.position.z+fococamera.x*2;
	camera.rotation.y = angulo;// Rotacionar
	//Mao do player
	Obj3Dglb.maos.objeto3D.rotation.y = angulo;// Rotacionar
	listLus[0].position.y = Obj3Dglb.maos.objeto3D.position.y+30;//camera
	listLus[0].position.x = Obj3Dglb.maos.objeto3D.position.x+fococamera.z*-20;
	listLus[0].position.z = Obj3Dglb.maos.objeto3D.position.z+fococamera.x*-20;

}

function moverPersonLado(varDirecao) {
	let velocidade = 5*varDirecao;
	positionCamera()
	
	/*
	let lateralx, lateralz = 0
	if(fococamera.z<=0 && fococamera.x<=0 && fococamera.z>=-5 && fococamera.x>=-5){
		fococamera.z = fococamera.z-varRot
		 //fococamera.x = fococamera.x+varRot
		lateralz =
		lateralx =		
	} else if(fococamera.z<=0 && fococamera.x>=0 && fococamera.z>=-5 && fococamera.x<=5){
		fococamera.z = fococamera.z+varRot
		fococamera.x = fococamera.x+varRot
	} else if(fococamera.z>=0 && fococamera.x>=0 && fococamera.z<=5 && fococamera.x<=5){
		fococamera.z = fococamera.z+varRot
		fococamera.x = fococamera.x-varRot
	} else if(fococamera.z>=0 && fococamera.x<=0 && fococamera.z<=5 && fococamera.x>=-5){
		fococamera.z = fococamera.z-varRot
		fococamera.x = fococamera.x-varRot
	}
	*/
	
	Obj3Dglb.maos.objeto3D.position.x = Obj3Dglb.maos.objeto3D.position.x+fococamera.ladoz*velocidade;
	Obj3Dglb.maos.objeto3D.position.z = Obj3Dglb.maos.objeto3D.position.z+fococamera.ladox*velocidade;

	if(colideForObjetos()){
		// Se bater em algo voltar para posição anterior.
		Obj3Dglb.maos.objeto3D.position.x = Obj3Dglb.maos.objeto3D.position.x-fococamera.ladoz*velocidade;
		Obj3Dglb.maos.objeto3D.position.z = Obj3Dglb.maos.objeto3D.position.z-fococamera.ladox*velocidade;
	}
	
	//renderizar();
}

function moverPersonagem(varDirecao) {
	let velocidade = 5*varDirecao;
	Obj3Dglb.maos.objeto3D.position.x = Obj3Dglb.maos.objeto3D.position.x+fococamera.z*velocidade;
	Obj3Dglb.maos.objeto3D.position.z = Obj3Dglb.maos.objeto3D.position.z+fococamera.x*velocidade;
	positionCamera()

	if(colideForObjetos()){
		// Se bater em algo voltar para posição anterior.
		Obj3Dglb.maos.objeto3D.position.x = Obj3Dglb.maos.objeto3D.position.x-fococamera.z*velocidade;
		Obj3Dglb.maos.objeto3D.position.z = Obj3Dglb.maos.objeto3D.position.z-fococamera.x*velocidade;
	}
}



function addEvent(el, type, callback){
	console.log("joystick - ["+type+"] Adiciona eventos pra navegadores modernos e antigos");
	//Erro no joystick.addEventListener
    if (el.addEventListener) {
         el.addEventListener(type, callback);
    } else if (el.attachEvent) {
         el.adttachEvent("on" + type, callback);
    }
}
  

// Inicio do controle ____________________________________________________________________________

function getTouchStart(el, e){
    // tocou a tela com o dedo
    e.pageY = e.touches[0].pageY;
    e.pageX = e.touches[0].pageX;
    console.log("!!!!!!!!!!!!!! _getTouchStart(), _pageY="+e.pageY+", _pageX="+e.pageX)
    //joystick.style.position  = 'absolute'; //position: absolute;
    funMousedown(el,e);
    //var novoe = e.touches[0];
    //funMousedown(joystick,novoe);
    //funMousedown(joystick,e.touches[0]); // iguinorar dulo clique.
  }

    function funMousedown(el,e) {
    //segurou joystick com o mouse.
    isMove = true;
	console.log(el)
    joystickInitLeft = el.offsetLeft; // <-----38
    joystickInitTop = el.offsetTop; // <-----398
    console.log("funMousedown(), Left="+joystickInitLeft+", Top="+joystickInitTop)
    //el.className += " isMoving"; // Não sei porqu isto esta aqui
    x = e.pageX; // <-----?
    y = e.pageY; // <-----?
    //x = window.event ? window.event.clientX : e.pageX; // <-----undefined
    //y = window.event ? window.event.clientY : e.pageY; // <-----undefined
    xel = x - el.offsetLeft; // <-----NaN
    yel = y - el.offsetTop; // <-----NaN
    console.log("funMousedown(), x="+x+", y="+y+", xel=z"+xel+", yel="+yel);
  }

  function getTouchMove(el,e){
    // Moveu o dedo na tela
    e.pageY = e.touches[0].pageY;
    e.pageX = e.touches[0].pageX;
    funMouseMove(el,e);
  }    

  function funMouseMove(el,e) {
    console.log("funMouseMove(), Left="+joystickInitLeft+", Top="+joystickInitTop);
    //movendo joystick (mouse)
    if (isMove) {
      e.preventDefault(); // Não sei o que faz
      //x = window.event ? window.event.clientX : e.pageX; // <-----undefined
      //y = window.event ? window.event.clientY : e.pageY; // <-----undefined
      x = e.pageX; // <-----?
      y = e.pageY; // <-----?
      //console.log("Movendo... , x="+x+", y="+y+", xel="+xel+", yel="+yel);
      el.style.left = (x - xel) + 'px';
      el.style.top  = (y - yel) + 'px';
	  
      var difLeft = el.offsetLeft-joystickInitLeft;
      var difTop = el.offsetTop-joystickInitTop;
	  
      if(difLeft<0){difLeft=-1*difLeft}
      if(difTop<0){difTop=-1*difTop}
	  
      if(difLeft>difTop){
        if(el.offsetLeft > joystickInitLeft){
		  if(el==joystick){
			rotacionar(-0.25); //(ok)
		  }else{
			moverPersonLado(+1);
		  }
        }else if(el.offsetLeft < joystickInitLeft){
          if(el==joystick){
			rotacionar(+0.25); //(ok)
		  }else{
			moverPersonLado(-1);
		  }
		}
      }if(difLeft<=difTop){
        if(el.offsetTop > joystickInitTop){
          if(el==joystick){
			moverPersonagem(+1); //(ok)
		  }else{
			atirar()
		  }
        }else if(el.offsetTop < joystickInitTop){
          if(el==joystick){
			moverPersonagem(-1); //(ok)
		  }else{
			atirar()
		  }
        }
      }
    }
  }
  
  function funmouseup() {
	console.log("funmouseup()");
    joystick.style.left = joystickConteiner.style.left;
    joystick.style.top  = joystickConteiner.style.top;
	joystick2.style.left = joystickConteiner2.style.left;
    joystick2.style.top  = joystickConteiner2.style.top;
    isMove = false;
  }

  //Escutando eventos joystick.
  function initJoystick() {
  
	joystickConteiner = document.getElementById("joystickConteinerID");
	joystick = document.getElementById("joystickID");
	joystickConteiner2 = document.getElementById("joystickConteinerID2");
	joystick2 = document.getElementById("joystickID2");
	
	//addEvent(document, "keydown", function (e) {keyPush(e)}); // Digitou no teclado
   //Usando a função addEvent() para verificar qual a melhor forma de escutar o evento.
	
	
    addEvent(joystick, "mousedown", function (e) {funMousedown(joystick,e)}); // Clicou com o mouse
	addEvent(joystick2, "mousedown", function (e) {funMousedown(joystick2,e)}); // Clicou com o mouse
	
	addEvent(joystickConteiner, "mousemove", function (e) {funMouseMove(joystick,e)}); //Moveu o mouse
	addEvent(joystickConteiner2, "mousemove", function (e) {funMouseMove(joystick2,e)}); //Moveu o mouse
	//addEvent(document, "mousemove", function (e) {funMouseMove(joystick,e)}); //Moveu o mouse
    addEvent(document, "mouseup", function () {funmouseup()}); //Soltou o mouse 
	
    //--------------------
	
    addEvent(joystick, "touchstart", function (e) {getTouchStart(joystick,e)}); // Clicou com o mouse
	addEvent(joystick2, "touchstart", function (e) {getTouchStart(joystick2,e)}); // Clicou com o mouse
	
	addEvent(joystickConteiner, "touchmove", function (e) {getTouchMove(joystick,e)}); //Moveu o mouse
	addEvent(joystickConteiner2, "touchmove", function (e) {getTouchMove(joystick2,e)}); //Moveu o mouse
	//addEvent(document, "touchmove", function (e) {getTouchMove(joystick,e)}); //Moveu o mouse
	addEvent(document, "touchend", function () {funmouseup()}); //Soltou o mouse
  };



</script>

<div class="divControles">
	<div class="justific controles">

		<div class="divControEsq">
			<div id="joystickConteinerID" class="joystickConteiner" >
				<div id="joystickID" class="joystickClass"></div>
			</div>
			<div>
				<span id="idSpanDados1" class="spanDados"></span><br/>
				<span id="idSpanDados2" class="spanDados"></span>
			</div>
		</div>
		

		<div class="divControCentro">
			<a href="javascript:initSalaEu()">
				5 Diretor
			</a><br/>
			<a href="javascript:initSalaDesign()">
				4 Designers
			</a><br/>
			<a href="javascript:initSalaTutorial()">
				3 Tutoriais
			</a><br/>
			<a href="javascript:initSalaGames()">
				2 jogos
			</a><br/>
			<a href="javascript:initSalaUtil()">
				1 Ferramentas
			</a><br/>
			<a href="javascript:initSalaHome()">
				0 Terreo (x)
			</a><br/>
		</div>
		<div>
			<span id="idSpanTitulo" class="spanDados"></span><br/>
			<span id="idSpanURL" class="spanDados"></span><br/>
		</div>

		<div class="divControDire">
			<div id="joystickConteinerID2" class="joystickConteiner" >
				<div id="joystickID2" class="joystickClass"></div>
			</div>
			<div>
				<span id="idSpanDados3" class="spanDados"></span>
			</div>
		</div>

	</div>		
</div>

<div id="DivIntro" class="divIntro">
	MetaversoVVC
	<a id="DivIntroA" href="javascript:init()">
		<br/><br/>Iniciar<br/>
	</a>
	<img id="DivIntroload" src="/static/assetsv5/img/loading1.gif" alt="carregando"/>	
<div>
	
</body>
</html>